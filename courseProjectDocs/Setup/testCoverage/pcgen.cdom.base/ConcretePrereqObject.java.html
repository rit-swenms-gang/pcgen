<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ConcretePrereqObject.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">pcgen</a> &gt; <a href="index.source.html" class="el_package">pcgen.cdom.base</a> &gt; <span class="el_source">ConcretePrereqObject.java</span></div><h1>ConcretePrereqObject.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2006 Aaron Divinsky &lt;boomer70@yahoo.com&gt;
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 */
package pcgen.cdom.base;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;
import java.util.Set;

import pcgen.base.util.ListSet;
import pcgen.core.PlayerCharacter;
import pcgen.core.prereq.PrereqHandler;
import pcgen.core.prereq.Prerequisite;
import pcgen.core.prereq.PrerequisiteUtilities;

/**
 * A ConcretePrereqObject is an object that contains a list of Prerequisites.
 * This list of Prerequisites is designed to serve as a list of conditions that
 * must be met before the PrereqObject can be &quot;used&quot;
 * 
 * ConcretePrereqObject is intended to provide a quick foundation class that
 * implements PrereqObject.
 */
<span class="fc" id="L40">public class ConcretePrereqObject implements Cloneable, PrereqObject</span>
{
	/** The list of prerequisites */
<span class="fc" id="L43">	private Set&lt;Prerequisite&gt; thePrereqs = null;</span>

	/**
	 * Returns a List of the Prerequisite objects contained in the PrereqObject.
	 * If the PrereqObject contains no Prerequisites, the return value may be
	 * null or an empty list, it is implementation-specific.
	 * 
	 * This method is value-semantic in that ownership of the returned List is
	 * transferred to the class calling this method. Modification of the
	 * returned List will not modify this ConcretePrereqObject and modification
	 * of this ConcretePrereqObject will not modify the returned List.
	 * 
	 * @return A List of Prerequisite objects contained in the PrereqObject.
	 */
	@Override
	public List&lt;Prerequisite&gt; getPrerequisiteList()
	{
<span class="fc bfc" id="L60" title="All 2 branches covered.">		if (thePrereqs == null)</span>
		{
<span class="fc" id="L62">			return Collections.emptyList();</span>
		}
<span class="fc" id="L64">		return List.copyOf(thePrereqs);</span>
	}

	/**
	 * Returns true if this object has any prerequisites of the kind that is
	 * passed in.
	 * 
	 * @param matchType
	 *            The kind of Prerequisite to test for.
	 * 
	 * @return &lt;tt&gt;true&lt;/tt&gt; if this object has a prerequisite of the kind
	 *         that is passed in
	 * 
	 * @see pcgen.core.prereq.Prerequisite#getKind()
	 */
	public final boolean hasPreReqTypeOf(final String matchType)
	{
<span class="nc bnc" id="L81" title="All 2 branches missed.">		if (!hasPrerequisites())</span>
		{
<span class="nc" id="L83">			return false;</span>
		}

<span class="nc" id="L86">		return getPrerequisiteList().stream()</span>
<span class="nc" id="L87">		                            .anyMatch(prereq -&gt; PrerequisiteUtilities.hasPreReqKindOf(prereq, matchType));</span>
	}

	/**
	 * Clones this ConcretePrereqObject. This is not a &quot;deep&quot; clone, in that the
	 * List of Prerequisites is cloned (to allow Prerequisites to be
	 * added/removed without altering the original or the clone), but the
	 * Prerequisites contained within the ConcretePrereqObject are not cloned.
	 */
	@Override
	public ConcretePrereqObject clone() throws CloneNotSupportedException
	{
<span class="nc" id="L99">		final ConcretePrereqObject obj = (ConcretePrereqObject) super.clone();</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">		if (thePrereqs != null)</span>
		{
<span class="nc" id="L102">			obj.thePrereqs = new ListSet&lt;&gt;();</span>
<span class="nc" id="L103">			obj.thePrereqs.addAll(thePrereqs);</span>
		}
<span class="nc" id="L105">		return obj;</span>
	}

	/**
	 * Adds a Collection of Prerequisite objects to the ConcretePrereqObject.
	 * 
	 * This method is both reference-semantic and value-semantic. This
	 * ConcretePrereqObject will not maintain a reference to or modify the given
	 * Collection. However, this ConcretePrereqObject will maintain a strong
	 * reference to the Prerequisite objects in the given Collection.
	 * 
	 * @param prereqs
	 *            A Collection of Prerequisite objects to added to the
	 *            ConcretePrereqObject.
	 */
	@Override
	public void addAllPrerequisites(final Collection&lt;Prerequisite&gt; prereqs)
	{
<span class="pc bpc" id="L123" title="1 of 4 branches missed.">		if (prereqs == null || prereqs.isEmpty())</span>
		{
<span class="fc" id="L125">			return;</span>
		}
<span class="pc bpc" id="L127" title="1 of 2 branches missed.">		if (thePrereqs == null)</span>
		{
<span class="fc" id="L129">			thePrereqs = new ListSet&lt;&gt;(prereqs.size());</span>
		}
<span class="fc bfc" id="L131" title="All 2 branches covered.">		for (final Prerequisite pre : prereqs)</span>
		{
<span class="fc" id="L133">			addPrerequisite(pre);</span>
<span class="fc" id="L134">		}</span>
<span class="fc" id="L135">	}</span>

	/**
	 * Add a Prerequisite to the ConcretePrereqObject.
	 * 
	 * If the Prerequisite kind is CLEAR all the prerequisites will be cleared
	 * from the list.
	 * 
	 * @param preReq
	 *            The Prerequisite to add to the ConcretePrereqObject.
	 */
	@Override
	public void addPrerequisite(Prerequisite preReq)
	{
<span class="fc bfc" id="L149" title="All 2 branches covered.">		if (preReq == null)</span>
		{
<span class="fc" id="L151">			return;</span>
		}
<span class="fc bfc" id="L153" title="All 2 branches covered.">		if (thePrereqs == null)</span>
		{
<span class="fc" id="L155">			thePrereqs = new ListSet&lt;&gt;();</span>
		}
<span class="fc" id="L157">		thePrereqs.add(preReq);</span>
<span class="fc" id="L158">	}</span>

	/**
	 * Remove All Prerequisites contained in the ConcretePrereqObject.
	 */
	@Override
	public void clearPrerequisiteList()
	{
<span class="fc" id="L166">		thePrereqs = null;</span>
<span class="fc" id="L167">	}</span>

	/**
	 * Returns the number of Prerequisites contained in the
	 * ConcretePrereqObject.
	 * 
	 * @return the number of Prerequisites contained in the
	 *         ConcretePrereqObject.
	 */
	@Override
	public int getPrerequisiteCount()
	{
<span class="pc bpc" id="L179" title="1 of 2 branches missed.">		if (thePrereqs == null)</span>
		{
<span class="fc" id="L181">			return 0;</span>
		}
<span class="nc" id="L183">		return thePrereqs.size();</span>
	}

	/**
	 * Returns true if this ConcretePrereqObject contains any Prerequisites;
	 * false otherwise.
	 * 
	 * @return true if this ConcretePrereqObject contains any Prerequisites;
	 *         false otherwise.
	 */
	@Override
	public boolean hasPrerequisites()
	{
<span class="fc bfc" id="L196" title="All 2 branches covered.">		return thePrereqs != null;</span>
	}

	/**
	 * Returns true if the given PrereqObject contains Prerequisites that are
	 * equal to the Prerequisites contained within this ConcretePrereqObject. If
	 * the number of Prerequisites does not match, or if the Prerequisites are
	 * not equal, this will return false.
	 * 
	 * @param other
	 *            The PrereqObject for which the Prerequisites will be compared
	 *            to the Prerequisites in this ConcretePrereqObject.
	 * @return true if the given PrereqObject contains Prerequisites that are
	 *         equal to the Prerequisites contained within this
	 *         ConcretePrereqObject; false otherwise
	 */
	public boolean equalsPrereqObject(PrereqObject other)
	{
<span class="fc bfc" id="L214" title="All 2 branches covered.">		if (this == other)</span>
		{
<span class="fc" id="L216">			return true;</span>
		}
<span class="fc" id="L218">		boolean otherHas = other.hasPrerequisites();</span>
<span class="fc bfc" id="L219" title="All 2 branches covered.">		if (!hasPrerequisites())</span>
		{
<span class="pc bpc" id="L221" title="1 of 2 branches missed.">			return !otherHas;</span>
		}
<span class="pc bpc" id="L223" title="1 of 2 branches missed.">		if (!otherHas)</span>
		{
<span class="nc" id="L225">			return false;</span>
		}
<span class="fc" id="L227">		List&lt;Prerequisite&gt; otherPRL = other.getPrerequisiteList();</span>
<span class="pc bpc" id="L228" title="1 of 2 branches missed.">		if (otherPRL.size() != thePrereqs.size())</span>
		{
<span class="nc" id="L230">			return false;</span>
		}
<span class="fc" id="L232">		List&lt;Prerequisite&gt; removed = new ArrayList&lt;&gt;(thePrereqs);</span>
<span class="fc" id="L233">		removed.removeAll(otherPRL);</span>
<span class="fc" id="L234">		return removed.isEmpty();</span>
	}

	/**
	 * Tests if the specified PlayerCharacter passes all the prerequisites.
	 * 
	 * @param aPC
	 *            The &lt;tt&gt;PlayerCharacter&lt;/tt&gt; to test.
	 * 
	 * @return &lt;tt&gt;true&lt;/tt&gt; if the PC passes all the prerequisites.
	 */
	public boolean qualifies(final PlayerCharacter aPC, Object owner)
	{
<span class="pc bpc" id="L247" title="3 of 4 branches missed.">		return !hasPrerequisites() || PrereqHandler.passesAll(this, aPC, owner);</span>
	}

	@Override
	public boolean isAvailable(PlayerCharacter aPC)
	{
<span class="nc" id="L253">		return true;</span>
	}

	@Override
	public boolean isActive(PlayerCharacter aPC)
	{
<span class="nc" id="L259">		return true;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>