<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PrintPreviewDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">pcgen</a> &gt; <a href="index.source.html" class="el_package">pcgen.gui2.dialog</a> &gt; <span class="el_source">PrintPreviewDialog.java</span></div><h1>PrintPreviewDialog.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2011 Connor Petty &lt;cpmeister@users.sourceforge.net&gt;
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 *
 */
package pcgen.gui2.dialog;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.print.Pageable;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.File;
import java.io.FilenameFilter;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;
import java.net.URI;
import java.text.NumberFormat;
import java.util.Collection;
import java.util.concurrent.ExecutionException;

import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.ComboBoxEditor;
import javax.swing.ComboBoxModel;
import javax.swing.DefaultComboBoxModel;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JDialog;
import javax.swing.JFormattedTextField;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.SwingWorker;

import pcgen.cdom.base.Constants;
import pcgen.facade.core.CharacterFacade;
import pcgen.gui2.PCGenFrame;
import pcgen.gui2.tools.Icons;
import pcgen.gui2.tools.Utility;
import pcgen.system.BatchExporter;
import pcgen.system.ConfigurationSettings;
import pcgen.util.Logging;
import pcgen.util.fop.FopTask;

import org.apache.commons.io.FileUtils;
import org.apache.commons.io.filefilter.FileFilterUtils;
import org.apache.commons.io.filefilter.IOFileFilter;
import org.apache.commons.io.filefilter.SuffixFileFilter;
import org.apache.commons.io.filefilter.TrueFileFilter;
import org.apache.fop.apps.FOUserAgent;
import org.apache.fop.render.awt.AWTRenderer;
import org.apache.fop.render.awt.viewer.PreviewPanel;
import org.jetbrains.annotations.NotNull;

/**
 * Dialog to allow the preview of character export.
 */
@SuppressWarnings(&quot;serial&quot;)
public final class PrintPreviewDialog extends JDialog implements ActionListener
{

    public static void showPrintPreviewDialog(PCGenFrame frame)
    {
<span class="nc" id="L91">        JDialog dialog = new PrintPreviewDialog(frame);</span>
<span class="nc" id="L92">        dialog.setLocationRelativeTo(frame);</span>
<span class="nc" id="L93">        dialog.setVisible(true);</span>
<span class="nc" id="L94">    }</span>

    private static final String SHEET_COMMAND = &quot;sheet&quot;;
    private static final String PAGE_COMMAND = &quot;page&quot;;
    private static final String ZOOM_COMMAND = &quot;zoom&quot;;
    private static final String ZOOM_IN_COMMAND = &quot;zoomin&quot;;
    private static final String ZOOM_OUT_COMMAND = &quot;zoomout&quot;;
    private static final String PRINT_COMMAND = &quot;print&quot;;
    private static final String CANCEL_COMMAND = &quot;cancel&quot;;
<span class="nc" id="L103">    private static final double ZOOM_MULTIPLIER = Math.pow(2, 0.125);</span>
    private final CharacterFacade character;
    private final JComboBox&lt;Object&gt; sheetBox;
    private final JComboBox&lt;String&gt; pageBox;
    private final JComboBox&lt;Double&gt; zoomBox;
    private final JButton zoomInButton;
    private final JButton zoomOutButton;
    private final JButton printButton;
    private final JButton cancelButton;
    private final JPanel previewPanelParent;
    private PreviewPanel previewPanel;
    private final JProgressBar progressBar;
    private final PCGenFrame frame;
    private Pageable pageable;

    private PrintPreviewDialog(PCGenFrame frame)
    {
<span class="nc" id="L120">        super(frame, true);</span>
<span class="nc" id="L121">        this.frame = frame;</span>
<span class="nc" id="L122">        this.character = frame.getSelectedCharacterRef().get();</span>
<span class="nc" id="L123">        this.previewPanelParent = new JPanel(new GridLayout(1, 1));</span>
<span class="nc" id="L124">        this.sheetBox = new JComboBox&lt;&gt;();</span>
<span class="nc" id="L125">        this.progressBar = new JProgressBar();</span>
<span class="nc" id="L126">        this.pageBox = new JComboBox&lt;&gt;();</span>
<span class="nc" id="L127">        this.zoomBox = new JComboBox&lt;&gt;();</span>
<span class="nc" id="L128">        this.zoomInButton = new JButton();</span>
<span class="nc" id="L129">        this.zoomOutButton = new JButton();</span>
<span class="nc" id="L130">        this.printButton = new JButton();</span>
<span class="nc" id="L131">        this.cancelButton = new JButton();</span>
<span class="nc" id="L132">        initComponents();</span>
<span class="nc" id="L133">        initLayout();</span>
<span class="nc" id="L134">        pack();</span>
<span class="nc" id="L135">        new SheetLoader().execute();</span>
<span class="nc" id="L136">    }</span>

    private &lt;E&gt; void initComponents()
    {
<span class="nc" id="L140">        setTitle(&quot;Print Preview&quot;);</span>
<span class="nc" id="L141">        sheetBox.setRenderer(new DefaultListCellRenderer()</span>
<span class="nc" id="L142">        {</span>

            @Override
            public Component getListCellRendererComponent(JList&lt;? extends Object&gt; list, Object value, int index,
                                                          boolean isSelected, boolean cellHasFocus)
            {
<span class="nc" id="L148">                super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">                if (value != null)</span>
                {
<span class="nc" id="L151">                    setToolTipText(value.toString());</span>
                }
<span class="nc" id="L153">                return this;</span>
            }

        });
<span class="nc" id="L157">        sheetBox.setActionCommand(SHEET_COMMAND);</span>
<span class="nc" id="L158">        sheetBox.addActionListener(this);</span>
<span class="nc" id="L159">        pageBox.addItem(&quot;0 of 0&quot;);</span>
<span class="nc" id="L160">        pageBox.setActionCommand(PAGE_COMMAND);</span>
<span class="nc" id="L161">        pageBox.addActionListener(this);</span>
<span class="nc" id="L162">        zoomBox.addItem(0.25);</span>
<span class="nc" id="L163">        zoomBox.addItem(0.50);</span>

<span class="nc" id="L165">        zoomBox.addItem(0.75);</span>
<span class="nc" id="L166">        zoomBox.addItem(1.00);</span>
<span class="nc" id="L167">        zoomBox.setSelectedItem(0.75);</span>
<span class="nc" id="L168">        zoomBox.setRenderer(new DefaultListCellRenderer()</span>
<span class="nc" id="L169">        {</span>

            @Override
            public Component getListCellRendererComponent(JList&lt;? extends Object&gt; list, Object value, int index,
                                                          boolean isSelected, boolean cellHasFocus)
            {
<span class="nc" id="L175">                NumberFormat format = NumberFormat.getPercentInstance();</span>
<span class="nc" id="L176">                String formattedValue = format.format(value);</span>
<span class="nc" id="L177">                return super.getListCellRendererComponent(list, formattedValue, index, isSelected, cellHasFocus);</span>
            }

        });
<span class="nc" id="L181">        zoomBox.setEditable(true);</span>
<span class="nc" id="L182">        zoomBox.setEditor(new PercentEditor(zoomBox));</span>
<span class="nc" id="L183">        zoomBox.setActionCommand(ZOOM_COMMAND);</span>
<span class="nc" id="L184">        zoomBox.addActionListener(this);</span>
<span class="nc" id="L185">        zoomInButton.setIcon(Icons.ZoomIn16.getImageIcon());</span>
<span class="nc" id="L186">        zoomInButton.setActionCommand(ZOOM_IN_COMMAND);</span>
<span class="nc" id="L187">        zoomInButton.addActionListener(this);</span>
<span class="nc" id="L188">        zoomOutButton.setIcon(Icons.ZoomOut16.getImageIcon());</span>
<span class="nc" id="L189">        zoomOutButton.setActionCommand(ZOOM_OUT_COMMAND);</span>
<span class="nc" id="L190">        zoomOutButton.addActionListener(this);</span>

<span class="nc" id="L192">        printButton.setText(&quot;Print&quot;);</span>
<span class="nc" id="L193">        printButton.setActionCommand(PRINT_COMMAND);</span>
<span class="nc" id="L194">        printButton.addActionListener(this);</span>

<span class="nc" id="L196">        cancelButton.setText(&quot;Cancel&quot;);</span>
<span class="nc" id="L197">        cancelButton.setActionCommand(CANCEL_COMMAND);</span>
<span class="nc" id="L198">        cancelButton.addActionListener(this);</span>

<span class="nc" id="L200">        enableEditGroup(false);</span>

<span class="nc" id="L202">        Utility.installEscapeCloseOperation(this);</span>
<span class="nc" id="L203">    }</span>

    private void enableEditGroup(boolean enable)
    {
<span class="nc" id="L207">        pageBox.setEnabled(enable);</span>
<span class="nc" id="L208">        zoomBox.setEnabled(enable);</span>
<span class="nc" id="L209">        zoomInButton.setEnabled(enable);</span>
<span class="nc" id="L210">        zoomOutButton.setEnabled(enable);</span>
<span class="nc" id="L211">        printButton.setEnabled(enable);</span>
<span class="nc" id="L212">    }</span>

    private void setPreviewPanel(PreviewPanel previewPanel)
    {
<span class="nc" id="L216">        previewPanelParent.removeAll();</span>
<span class="nc" id="L217">        this.previewPanel = previewPanel;</span>
<span class="nc" id="L218">        previewPanelParent.add(previewPanel);</span>
<span class="nc" id="L219">        previewPanel.reload();</span>
<span class="nc" id="L220">    }</span>

    @Override
    public void actionPerformed(ActionEvent e)
    {
<span class="nc bnc" id="L225" title="All 2 branches missed.">        if (SHEET_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L227">            new PreviewLoader((URI) sheetBox.getSelectedItem()).execute();</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">        } else if (PAGE_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L230">            previewPanel.setPage(pageBox.getSelectedIndex());</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">        } else if (ZOOM_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L233">            Double zoom = (Double) zoomBox.getSelectedItem();</span>
<span class="nc" id="L234">            previewPanel.setScaleFactor(zoom);</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">        } else if (ZOOM_IN_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L237">            Double zoom = (Double) zoomBox.getSelectedItem();</span>
<span class="nc" id="L238">            zoomBox.setSelectedItem(zoom * ZOOM_MULTIPLIER);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">        } else if (ZOOM_OUT_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L241">            Double zoom = (Double) zoomBox.getSelectedItem();</span>
<span class="nc" id="L242">            zoomBox.setSelectedItem(zoom / ZOOM_MULTIPLIER);</span>
<span class="nc bnc" id="L243" title="All 2 branches missed.">        } else if (PRINT_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L245">            PrinterJob printerJob = PrinterJob.getPrinterJob();</span>
<span class="nc" id="L246">            printerJob.setPageable(pageable);</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">            if (printerJob.printDialog())</span>
            {
                try
                {
<span class="nc" id="L251">                    printerJob.print();</span>
<span class="nc" id="L252">                    dispose();</span>
<span class="nc" id="L253">                } catch (PrinterException ex)</span>
                {
<span class="nc" id="L255">                    String message = &quot;Could not print &quot; + character.getNameRef().get();</span>
<span class="nc" id="L256">                    Logging.errorPrint(message, ex);</span>
<span class="nc" id="L257">                    frame.showErrorMessage(Constants.APPLICATION_NAME, message);</span>
<span class="nc" id="L258">                }</span>
            }
<span class="nc bnc" id="L260" title="All 2 branches missed.">        } else if (CANCEL_COMMAND.equals(e.getActionCommand()))</span>
        {
<span class="nc" id="L262">            dispose();</span>
        }
<span class="nc" id="L264">    }</span>

    private void initLayout()
    {
<span class="nc" id="L268">        Container pane = getContentPane();</span>
<span class="nc" id="L269">        pane.setLayout(new BorderLayout());</span>
        {//layout top bar
<span class="nc" id="L271">            JPanel bar = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L272">            GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L273">            gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L274">            gbc.anchor = GridBagConstraints.BASELINE;</span>
<span class="nc" id="L275">            gbc.insets = new Insets(8, 6, 8, 2);</span>
<span class="nc" id="L276">            bar.add(new JLabel(&quot;Select Template:&quot;), gbc);</span>
<span class="nc" id="L277">            gbc.insets = new Insets(8, 2, 8, 6);</span>
<span class="nc" id="L278">            gbc.weightx = 1;</span>
<span class="nc" id="L279">            bar.add(sheetBox, gbc);</span>
<span class="nc" id="L280">            pane.add(bar, BorderLayout.NORTH);</span>
        }
        {
<span class="nc" id="L283">            Box vbox = Box.createVerticalBox();</span>
<span class="nc" id="L284">            previewPanelParent.setPreferredSize(new Dimension(600, 800));</span>
<span class="nc" id="L285">            vbox.add(previewPanelParent);</span>
<span class="nc" id="L286">            vbox.add(progressBar);</span>
<span class="nc" id="L287">            pane.add(vbox, BorderLayout.CENTER);</span>
        }
        {
<span class="nc" id="L290">            Box hbox = Box.createHorizontalBox();</span>
<span class="nc" id="L291">            hbox.add(new JLabel(&quot;Page:&quot;));</span>
<span class="nc" id="L292">            hbox.add(Box.createHorizontalStrut(4));</span>
<span class="nc" id="L293">            hbox.add(pageBox);</span>
<span class="nc" id="L294">            hbox.add(Box.createHorizontalStrut(10));</span>
<span class="nc" id="L295">            hbox.add(new JLabel(&quot;Zoom:&quot;));</span>
<span class="nc" id="L296">            hbox.add(Box.createHorizontalStrut(4));</span>
<span class="nc" id="L297">            hbox.add(zoomBox);</span>
<span class="nc" id="L298">            hbox.add(Box.createHorizontalStrut(5));</span>
<span class="nc" id="L299">            hbox.add(zoomInButton);</span>
<span class="nc" id="L300">            hbox.add(Box.createHorizontalStrut(5));</span>
<span class="nc" id="L301">            hbox.add(zoomOutButton);</span>
<span class="nc" id="L302">            hbox.add(Box.createHorizontalGlue());</span>
<span class="nc" id="L303">            hbox.add(printButton);</span>
<span class="nc" id="L304">            hbox.add(Box.createHorizontalStrut(5));</span>
<span class="nc" id="L305">            hbox.add(cancelButton);</span>
<span class="nc" id="L306">            hbox.setBorder(BorderFactory.createEmptyBorder(8, 5, 8, 5));</span>
<span class="nc" id="L307">            pane.add(hbox, BorderLayout.SOUTH);</span>
        }
<span class="nc" id="L309">    }</span>

    /**
     * A JFormattedTextField that edits percentages.
     */
    private static class PercentEditor extends JFormattedTextField implements ComboBoxEditor, PropertyChangeListener
    {

        public PercentEditor(JComboBox&lt;Double&gt; comboBox)
        {
<span class="nc" id="L319">            super(NumberFormat.getPercentInstance());</span>
<span class="nc" id="L320">            addPropertyChangeListener(&quot;value&quot;, this);</span>
            //We steal the border from the LAF's editor
<span class="nc" id="L322">            JComponent oldEditor = (JComponent) comboBox.getEditor().getEditorComponent();</span>
<span class="nc" id="L323">            setBorder(oldEditor.getBorder());</span>
<span class="nc" id="L324">        }</span>

        @Override
        public Component getEditorComponent()
        {
<span class="nc" id="L329">            return this;</span>
        }

        @Override
        public void setItem(Object anObject)
        {
<span class="nc" id="L335">            setValue(anObject);</span>
<span class="nc" id="L336">        }</span>

        @Override
        public Object getItem()
        {
<span class="nc" id="L341">            return getValue();</span>
        }

        @Override
        public void propertyChange(PropertyChangeEvent evt)
        {
<span class="nc" id="L347">            fireActionPerformed();</span>
<span class="nc" id="L348">        }</span>

    }

    private class PreviewLoader extends SwingWorker&lt;AWTRenderer, Object&gt;
    {

        private final URI uri;

        public PreviewLoader(URI uri)
<span class="nc" id="L358">        {</span>
<span class="nc" id="L359">            this.uri = uri;</span>
<span class="nc" id="L360">            progressBar.setIndeterminate(true);</span>
<span class="nc" id="L361">            sheetBox.setEnabled(false);</span>
<span class="nc" id="L362">            enableEditGroup(false);</span>
<span class="nc" id="L363">        }</span>

        @Override
        protected AWTRenderer doInBackground() throws Exception
        {
<span class="nc" id="L368">            URI osPath = new File(ConfigurationSettings.getOutputSheetsDir()).toURI();</span>
<span class="nc" id="L369">            File xsltFile = new File(osPath.resolve(uri));</span>

<span class="nc" id="L371">            FOUserAgent userAgent = FopTask.getFactory().newFOUserAgent();</span>
<span class="nc" id="L372">            AWTRenderer renderer = new AWTRenderer(userAgent, null, false, false);</span>

<span class="nc" id="L374">            try (PipedOutputStream out = new PipedOutputStream())</span>
            {
<span class="nc" id="L376">                FopTask task = FopTask.newFopTask(new PipedInputStream(out), xsltFile, renderer);</span>
<span class="nc" id="L377">                Thread thread = new Thread(task, &quot;fop-preview&quot;);</span>

<span class="nc" id="L379">                thread.setDaemon(true);</span>
<span class="nc" id="L380">                thread.start();</span>
<span class="nc" id="L381">                BatchExporter.exportCharacter(character, out);</span>
                try
                {
<span class="nc" id="L384">                    thread.join();</span>
<span class="nc" id="L385">                } catch (InterruptedException ex)</span>
                {
                    //pass on the interrupt and hope it stops
<span class="nc" id="L388">                    thread.interrupt();</span>
<span class="nc" id="L389">                }</span>
            }
<span class="nc" id="L391">            return renderer;</span>
        }

        @Override
        protected void done()
        {
<span class="nc" id="L397">            progressBar.setIndeterminate(false);</span>
<span class="nc" id="L398">            sheetBox.setEnabled(true);</span>
<span class="nc" id="L399">            enableEditGroup(true);</span>
            try
            {
<span class="nc" id="L402">                AWTRenderer renderer = get();</span>
<span class="nc" id="L403">                pageable = renderer;</span>
<span class="nc" id="L404">                setPreviewPanel(new PreviewPanel(renderer.getUserAgent(), null, renderer));</span>
<span class="nc" id="L405">                pageBox.setModel(createPagesModel(renderer.getNumberOfPages()));</span>
<span class="nc" id="L406">            } catch (InterruptedException | ExecutionException ex)</span>
            {
<span class="nc" id="L408">                Logging.errorPrint(&quot;Could not load sheet&quot;, ex);</span>
<span class="nc" id="L409">            }</span>
<span class="nc" id="L410">        }</span>

    }

    private static ComboBoxModel&lt;String&gt; createPagesModel(int pages)
    {
<span class="nc" id="L416">        String[] pageNumbers = new String[pages];</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">        for (int i = 0; i &lt; pages; i++)</span>
        {
<span class="nc" id="L419">            pageNumbers[i] = (i + 1) + &quot; of &quot; + pages;</span>
        }
<span class="nc" id="L421">        return new DefaultComboBoxModel&lt;&gt;(pageNumbers);</span>
    }

<span class="nc" id="L424">    private class SheetLoader extends SwingWorker&lt;Object[], Object&gt; implements FilenameFilter</span>
    {

        @Override
        public boolean accept(@NotNull File dir, @NotNull String name)
        {
<span class="nc" id="L430">            return dir.getName().equalsIgnoreCase(&quot;pdf&quot;);</span>
        }

        @Override
        protected Object[] doInBackground()
        {
<span class="nc" id="L436">            IOFileFilter pdfFilter = FileFilterUtils.asFileFilter(this);</span>
<span class="nc" id="L437">            IOFileFilter suffixFilter = FileFilterUtils.notFileFilter(new SuffixFileFilter(&quot;.fo&quot;));</span>
<span class="nc" id="L438">            IOFileFilter sheetFilter = FileFilterUtils.prefixFileFilter(Constants.CHARACTER_TEMPLATE_PREFIX);</span>
<span class="nc" id="L439">            IOFileFilter fileFilter = FileFilterUtils.and(pdfFilter, suffixFilter, sheetFilter);</span>

<span class="nc" id="L441">            IOFileFilter dirFilter = TrueFileFilter.INSTANCE;</span>
<span class="nc" id="L442">            File dir = new File(ConfigurationSettings.getOutputSheetsDir());</span>
<span class="nc" id="L443">            Collection&lt;File&gt; files = FileUtils.listFiles(dir, fileFilter, dirFilter);</span>
<span class="nc" id="L444">            URI osPath = new File(ConfigurationSettings.getOutputSheetsDir()).toURI();</span>
<span class="nc" id="L445">            return files.stream().map(v -&gt; osPath.relativize(v.toURI())).toArray();</span>
        }

        @Override
        protected void done()
        {
            try
            {
<span class="nc" id="L453">                ComboBoxModel&lt;Object&gt; model = new DefaultComboBoxModel&lt;&gt;(get());</span>
<span class="nc" id="L454">                model.setSelectedItem(null);</span>
<span class="nc" id="L455">                sheetBox.setModel(model);</span>
<span class="nc" id="L456">            } catch (InterruptedException | ExecutionException ex)</span>
            {
<span class="nc" id="L458">                Logging.errorPrint(&quot;could not load sheets&quot;, ex);</span>
<span class="nc" id="L459">            }</span>
<span class="nc" id="L460">        }</span>

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>